<!DOCTYPE html><html itemscope itemtype="http://schema.org/Article" lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Implementation guide including code samples to validate tracking of Google Analytics Exceptions using Google Analytics Web Tester."><meta name="author" content="Philippe Sawicki"><meta name="copyright" content="Philippe Sawicki 2014-2015"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="theme-color" content="#f7991c"><link rel="canonical" href="https://philsawicki.github.io/GoogleAnalytics-WebTester/examples-exception-tracking.html"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//cdnjs.cloudflare.com"><link rel="dns-prefetch" href="//ajax.googleapis.com"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic"><link rel="stylesheet" href="public/css/main.css"><meta property="fb:admins" content="814194595"><meta property="fb:app_id" content="1619012241663368"><meta property="fb:profile_id" content="814194595"><meta property="og:site_name" content="Google Analytics Web Tester"><meta property="og:title" content="Tracking Exceptions"><meta property="og:type" content="article"><meta property="og:see_also" content="https://philsawicki.github.io/GoogleAnalytics-WebTester,http://philippesawicki.com"><meta property="og:image" content="https://philsawicki.github.io/GoogleAnalytics-WebTester/public/images/Google-Analytics-Web-Tester-Social.png"><meta property="og:url" content="https://philsawicki.github.io/GoogleAnalytics-WebTester/examples-exception-tracking.html"><meta property="og:description" content="Implementation guide including code samples to validate tracking of Google Analytics Exceptions using Google Analytics Web Tester."><meta property="article:author" content="https://facebook.com/philippe.sawicki"><meta property="article:tag" content="google,analytics,validation"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@fyll_s"><meta name="twitter:creator" content="@fyll_s"><meta name="twitter:title" content="Tracking Exceptions"><meta name="twitter:description" content="Implementation guide including code samples to validate tracking of Google Analytics Exceptions using Google Analytics Web Tester."><meta name="twitter:image:src" content="https://philsawicki.github.io/GoogleAnalytics-WebTester/public/images/Google-Analytics-Web-Tester-Social.png"><meta itemprop="name" content="Tracking Exceptions"><meta itemprop="description" content="Implementation guide including code samples to validate tracking of Google Analytics Exceptions using Google Analytics Web Tester."><meta itemprop="image" content="https://philsawicki.github.io/GoogleAnalytics-WebTester/public/images/Google-Analytics-Web-Tester-Social.png"><title>Exception Tracking Code Samples - Google Analytics Web Tester</title></head><body><script type="text/javascript">
      if (location.hostname === 'localhost') {
      	(function (w) {
      		w.ga = function () {};
      	})(window);
      } else {
      	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      }
      ga('create', {
      	trackingId: 'UA-60737019-3',
      	cookieDomain: 'auto', 
      	siteSpeedSampleRate: 100
      });
      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script><nav class="navbar navbar-default navbar-fixed-top"><div class="container"><div class="navbar-header"><a href="index.html" class="navbar-brand">Google Analytics Web Tester</a> <button type="button" data-toggle="collapse" data-target="#navbar-main" aria-expanded="flase" aria-controls="navbar" class="navbar-toggle collapsed"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div id="navbar-main" class="navbar-collapse collapse"><ul class="nav navbar-nav"><li class="dropdown"><a data-toggle="dropdown" href="#" id="Project" class="dropdown-toggle">Project <span class="caret"></span></a><ul aria-labelledby="Project" class="dropdown-menu"><li><a href="how-does-it-work.html">How does it work?</a></li><li><a href="about-the-demo-application.html">About the Demo App</a></li><li><a id="githubSite" href="https://github.com/philsawicki/GoogleAnalytics-WebTester" title="View Google Analytics Website Checker project on Github">View on GitHub</a></li><li><a id="downloadZip" href="https://github.com/philsawicki/GoogleAnalytics-WebTester/zipball/master" title="Download Google Analytics Web Tester">Download <span class="label label-default" style="margin-left: 7px;">Free</span></a></li></ul></li><li class="dropdown"><a data-toggle="dropdown" href="#" id="codeSamples" class="dropdown-toggle">Code Samples <span class="caret"></span></a><ul aria-labelledby="codeSamples" class="dropdown-menu"><li><a href="examples-pageviews.html">Pageviews</a></li><li><a href="examples-events.html">Events</a></li><li><a href="examples-custom-metrics.html">Custom Metrics</a></li><li><a href="examples-custom-dimensions.html">Custom Dimensions</a></li><li><a href="examples-enhanced-ecommerce.html">Enhanced E-Commerce<span style="margin-left: 7px;" class="label label-default">New</span></a></li><li><a href="examples-content-grouping.html">Content Grouping<span style="margin-left: 7px;" class="label label-default">New</span></a></li><li><a href="examples-social-interactions.html">Social Interactions</a></li><li><a href="examples-user-timings.html">User Timings</a></li><li><a href="examples-cross-device-tracking.html">Cross-Device Tracking<span style="margin-left: 7px;" class="label label-default">New</span></a></li><li class="active"><a href="examples-exception-tracking.html">Exception Tracking<span style="margin-left: 7px;" class="label label-default">New</span></a></li></ul></li><li class="dropdown"><a data-toggle="dropdown" href="#" id="resources" class="dropdown-toggle">Resources <span class="caret"></span></a><ul aria-labelledby="resources" class="dropdown-menu"><li><a href="index.html#about">About this Site</a></li><li><a href="index.html#help">Help & Feedback</a></li><li><a href="contact.html">Contact</a></li></ul></li></ul></div></div></nav><div class="container-fluid"><div class="row"><div class="col-sm-3 col-md-2 sidebar"><p><a href="index.html"><strong>Home</strong></a></p><p><strong>Project</strong></p><ul class="nav nav-sidebar"><li><a href="how-does-it-work.html">How does it work?</a></li><li><a href="about-the-demo-application.html">About the Demo Application</a></li><li><a id="githubSite" href="https://github.com/philsawicki/GoogleAnalytics-WebTester" title="View Google Analytics Website Checker project on Github">View on GitHub</a></li><li><a id="downloadZip" href="https://github.com/philsawicki/GoogleAnalytics-WebTester/zipball/master" title="Download Google Analytics Web Tester">Download <small><span class="label label-primary">Free!</span></small></a></li></ul><p><strong>Code Samples</strong></p><ul class="nav nav-sidebar"><li><a href="examples-pageviews.html">Pageviews</a></li><li><a href="examples-events.html">Events</a></li><li><a href="examples-custom-metrics.html">Custom Metrics</a></li><li><a href="examples-custom-dimensions.html">Custom Dimensions</a></li><li><a href="examples-enhanced-ecommerce.html">Enhanced E-Commerce<small><span style="margin-left: 7px;" class="label label-primary">New!</span></small></a></li><li><a href="examples-content-grouping.html">Content Grouping<small><span style="margin-left: 7px;" class="label label-primary">New!</span></small></a></li><li><a href="examples-social-interactions.html">Social Interactions</a></li><li><a href="examples-user-timings.html">User Timings</a></li><li><a href="examples-cross-device-tracking.html">Cross-Device Tracking<small><span style="margin-left: 7px;" class="label label-primary">New!</span></small></a></li><li class="active"><a href="examples-exception-tracking.html">Exception Tracking<small><span style="margin-left: 7px;" class="label label-default">New!</span></small></a></li></ul><p><strong>Resources</strong></p><ul class="nav nav-sidebar"><li><a href="index.html#about">About this Site</a></li><li><a href="index.html#help">Help & Feedback</a></li><li><a href="contact.html">Contact</a></li></ul></div><div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main"><div class="Titles Titles--hero"><h1 class="page-header">Tracking Exceptions</h1></div><ol class="breadcrumb"><li itemscope itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://philsawicki.github.io/GoogleAnalytics-WebTester/index.html" itemprop="url"><span itemprop="title">Home</span></a></li><li itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="active"><span itemprop="url" class="hidden">https://philsawicki.github.io/GoogleAnalytics-WebTester/examples-exception-tracking.html</span><span itemprop="title">Tracking Exceptions</span></li></ol><h2 id="gaDataStructure" class="sub-header">Google Analytics Data Structure</h2><p>To validate tracking of Exceptions, use the following Array in your Jasmine expectations:</p><pre><code class="javascript hljs well">['send', 'exception', { ─────────────────> 1&2. (Standard Google Analytics parameters)
   'exDescription': 'DatabaseError', ────> 3. Exception Description
   'exFatal': false, ────────────────────> 4. Indicates whether the exception was fatal
   'appName', 'Demo_Application', ───────> 5. Application Name
   'appVersion', '1.0' ──────────────────> 6. Application Version Number
}]
</code></pre><h2 id="sampleJasmineSpecFile" class="sub-header">Sample Jasmine Spec File</h2><p>Using direct <code>ga()</code> calls, checking proper tracking of Exceptions could be done in the following manner:</p><pre><code class="javascript hljs well">describe('The Google Analytics "Exception" tracking', function () {
   beforeEach(function () {
      // Load the page to test:
      browser.get('index.html');

      // Register the Google Analytics Event Data Interceptor:
      browser.driver.registerGoogleAnalyticsEventDataInterceptor();
   });
 
   it('should register an Exception when causing an application crash', function (done) {
      // Get the "LastEvent" object back from the browser:
      browser.driver.executeScript(function () {
         return window.GAWebTester.getLastEvent();
      })
      .then(
         // Validate the content of the "LastData" object:
         function successCallback (LastData) {
            expect( LastData ).toEqual( ['send', 'exception', {
               'exDescription': 'DatabaseError',
               'exFatal': false,
               'appName': 'Demo_Application',
               'appVersion': '1.0'
            }] );
         },
         // If there was an error getting back the "LastData" object from the browser, fail the test:
         function errorCallback (error) {
            fail('Should not have received Error: ' + JSON.stringify(error));
         }
      )
      .then(done);
   });
});
</code></pre><p>To manually simulate an Error in the browser, the following code will send a <code>DatabaseError</code> Exception:</p><pre><code class="javascript hljs well">/**
 * Trigger an Exception in the Browser by throwing an Error then catching
 * it with a "ga()" call.
 *
 * @return {void}
 */
function triggerGoogleAnalyticsException () {
   try {
      throw new Error('DatabaseError.');
   } catch (err) {
      // Send the exception to Google Analytics:
      ga('send', 'exception', {
         'exDescription': err.message,
         'exFatal': false,
         'appName': 'Demo_Application',
         'appVersion': '1.0'
      });
   }
}

// Trigger a "crash" in the browser:
triggerGoogleAnalyticsException();
</code></pre><h2 id="loggingJSErrors" class="sub-header">Logging JavaScript Errors</h2><p>Few people know about this, but the free version of Google Analytics supports exception logging. It might be caused by the fact that Google Analytics does not provide any built-in Report surfacing that information. Fortunately, that does not prevent you from making your own.</p><p>First, you will need to either:</p><ul><li>Include the following JavaScript code snippet into your application.</li><li>Use Google Tag Manager to inject it into every single page of your site.</li></ul><p>You can customize a few things:</p><ul><li><code>appName</code> (<em>string</em>): Name of the application you are tracking</li><li><code>appVersion</code> (<em>string</em>): Version number and/or deployment date of the application</li><li><code>exFatal</code> (<em>boolean</em>): “true” or “false”, depending on the Type of Error received</li></ul><p>You can test that the everything is properly set up by opening your browser’s developer console and typing <code>throw new Error('Crash!')</code>, then checking your Custom Report a few minutes later to make sure your Error is logged.</p><p>For the complete walkthrough of how to set it up, and a free <em>Error Reporting Dashboard</em>, see the full post on <a href="http://philippesawicki.com/tracking-website-errors-with-google-analytics/" target="blank" title="Tracking Website Error with Google Analytics" rel="me">philippesawicki.com</a>.</p><pre><code class="javascript hljs well">/**!
 * Send JavaScript error information to Google Analytics.
 * 
 * @param  {Window}           window  A reference to the "window".
 * @param  {Object|undefined} options An object containing optional "applicationName" and
 *                                    "applicationVersion" strings.
 * @return {void}
 * @author Philippe Sawicki (https://github.com/philsawicki)
 * @copyright Copyright 2015 Philippe Sawicki (http://philippesawicki.com)
 */
(function (window, options) {
   // Retain a reference to the previous global error handler, in case it has been set:
   var originalWindowErrorCallback = window.onerror;
       
   /**
    * Log any script error to Google Analytics.
    *
    * Third-party scripts without CORS will only provide "Script Error." as an error message.
    * 
    * @param  {String}           errorMessage Error message.
    * @param  {String}           url          URL where error was raised.
    * @param  {Number}           lineNumber   Line number where error was raised.
    * @param  {Number|undefined} columnNumber Column number for the line where the error occurred.
    * @param  {Object|undefined} errorObject  Error Object.
    * @return {Boolean}                       When the function returns true, this prevents the 
    *                                         firing of the default event handler.
    */
   window.onerror = function customErrorHandler (errorMessage, url, lineNumber, columnNumber, errorObject) {
       // Send error details to Google Analytics, if the library is already available:
       if (typeof ga === 'function') {
           // In case the "errorObject" is available, use its data, else fallback 
           // on the default "errorMessage" provided:
           var exceptionDescription = errorMessage;
           if (typeof errorObject !== 'undefined' && typeof errorObject.message !== 'undefined') {
               exceptionDescription = errorObject.message;
           }
 
           // Format the message to log to Analytics (might also use "errorObject.stack" if defined):
           exceptionDescription += ' @ ' + url + ':' + lineNumber + ':' + columnNumber;
 
           // Data Object to send to Google Analytics:
           var exOptions = {
               exDescription: exceptionDescription,
               exFatal: false // Some Error types might be considered as fatal.
           };
 
           // Format additional Data Object Properties, if any option given:
           if (typeof options !== 'undefined') {
               if (typeof options.applicationName !== 'undefined') {
                   exOptions.appName = options.applicationName;
               }
               if (typeof options.applicationVersion !== 'undefined') {
                   exOptions.appVersion = options.applicationVersion;
               }
           }
 
           // Send Data Object to Google Analytics:
           ga('send', 'exception', exOptions);
       }
 
       // If the previous "window.onerror" callback can be called, pass it the data:
       if (typeof originalWindowErrorCallback === 'function') {
           return originalWindowErrorCallback(errorMessage, url, lineNumber, columnNumber, errorObject);
       }
 
       // Otherwise, let the default handler run:
       return false;
   };
})(window, {
    applicationName: 'Application_Name', // Optional "Application Name" parameter (set your own).
    applicationVersion: '1.0'            // Optional "Application Version" parameter (set your own).
});
 
// Generate an error, for demonstration purposes:
//throw new Error('Crash!');</code></pre><hr><footer class="footer"><p class="text-muted">&copy; Copyright 2015 <a href="http://philippesawicki.com" target="_blank" title="Philippe Sawicki - Full Stack Developer &amp; Digital Analyst" rel="me">Philippe Sawicki</a></p></footer></div></div></div><script type="application/ld+json">[{"@context":"http://schema.org","@type":"Person","name":"Philippe Sawicki","jobTitle":"Full Stack Developer","url":"http://philippesawicki.com","sameAs":["https://facebook.com/philippe.sawicki","https://twitter.com/fyll_s","https://plus.google.com/+PhilippeSawicki","https://linkedin.com/in/philippesawicki"]},{"@context":"http://schema.org","@type":"WebSite","name":"Google Analytics Web Tester","alternateName":"GA Web Tester","url":"https://philsawicki.github.io/GoogleAnalytics-WebTester/"}]</script><script type="text/javascript">
      function asyncLoad (src, callback) {
      	var s = document.createElement('script');
      	s.type = 'text/javascript';
      	s.async = true;
      	s.src = src;
      	if (typeof callback === 'function') {
      		s.addEventListener('load', callback, false);
      	}
      	var h = document.getElementsByTagName('head')[0];
      	h.appendChild(s);
      }
      asyncLoad('//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js', function (event) {
      	if (typeof hljs !== 'undefined') {
      		hljs.initHighlighting();
      	}
      });
      asyncLoad('//ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js', function (event) {
      	asyncLoad('public/js/main.min.js');
      });
    </script></body></html>