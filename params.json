{"name":"GoogleAnalytics-WebTester","tagline":"A testing tool to validate Google Analytics implementation on a website","body":"[![Build Status](https://travis-ci.org/philsawicki/GoogleAnalytics-WebTester.svg?branch=master)](https://travis-ci.org/philsawicki/GoogleAnalytics-WebTester)\r\n[![Dependency Status](https://david-dm.org/philsawicki/GoogleAnalytics-WebTester.svg)](https://david-dm.org/philsawicki/GoogleAnalytics-WebTester)\r\n[![devDependency Status](https://david-dm.org/philsawicki/GoogleAnalytics-WebTester/dev-status.svg)](https://david-dm.org/philsawicki/GoogleAnalytics-WebTester#info=devDependencies)\r\n\r\n# Google Analytics Web Tester\r\n\r\n> Live, continuous audit of Google Analytics implementations\r\n\r\nTesting proper implementation of Google Analytics Tracking on a website can be a tricky thing to do. Unless you run a daily gamut of tests, what works one day may be broken the next one without you ever noticing.\r\n\r\nBut it doesn't have to be that way.\r\n\r\n___\r\n\r\n<!---\r\nAutomating the process of validating that tracking events are fired when the user interacts with the page can ease the development process and speed up the delivery of new features. It can also contribute to the sharing of Analytics knowledge by empowering everyone on the team with particular responsibilities:\r\n\r\n* Digital Marketers spend less time working out the implementation details ;\r\n* Business Analysts can formulate proper Acceptance Criterias for their User Stories ;\r\n* Developers can gain a better understanding of the business goals ;\r\n* QAs can spend more time testing other parts of the application.\r\n-->\r\n\r\nThis library eases the process of writing automated tests by providing a set of easy to use utility methods. It comes with an AngularJS demo application to show how to validate that the `ga()` snippet receives the expected data when the user interacts with the page.\r\n\r\n\r\nWhether using the Google Analytics snippet directly (`ga()`) or Google Tag Manager, all tracking interactions can be recorded the exact same way:\r\n\r\n* Pageviews\r\n* Custom Events\r\n* Custom Metrics / Dimensions\r\n* Enhanced E-Commerce\r\n* Social Interactions\r\n* Timings\r\n* etc.\r\n\r\nJust set the URL of your website, write a couple of specs and run the app, or set it to run after each build/deployment.\r\n\r\nEasy!\r\n\r\n## Preview\r\n\r\nHere's what the demo Application looks like:\r\n![Google Analytics Web Tester Demo Application](https://raw.githubusercontent.com/philsawicki/GoogleAnalytics-WebTester/screenshots/Google%20Analytics%20Web%20Tester%20Demo%20Application%20Screenshot.png \"Google Analytics Web Tester Demo Application\")\r\n\r\n## How does it work?\r\n\r\nThe library uses the [Protractor](http://angular.github.io/protractor/#/ \"Protractor\") test runner and [Jasmine](http://jasmine.github.io/ \"Jasmine\")'s BDD notation to execute End-to-End (E2) tests in real browsers (Chrome, Firefox, Safari, IE, PhantomJS, etc.). \r\n\r\nIt's fast, lightweight, easy to configure, and integrates beautifully with existing build systems, providing nice integration reports with Jenkins, Travis CI and many others.\r\n\r\n### Sample Spec file\r\n```javascript\r\ndescribe('Google Analytics \"click\" tracking', function () {\r\n   it('should fire an Event when clicking on the Jumbotron CTA', function (done) {\r\n      // Click on the \"Jumbotron\" CTA:\r\n      element( by.css('#jumbotronCTA') ).click();\r\n  \r\n      // Get the \"gaLastEventData\" object back from the browser:\r\n      browser.driver.executeScript(function () {\r\n         return window.gaLastEventData;\r\n      })\r\n      .then(\r\n         // Validate the content of the \"gaLastEventData\" object:\r\n         function successCallback (gaLastEventData) {\r\n            expect(gaLastEventData).toEqual(['send', 'event', 'Button', 'Click', 'Jumbotron CTA']);\r\n         },\r\n         // If there was an error getting back the \"gaLastEventData\" object from the browser, fail the test:\r\n         function errorCallback (error) {\r\n            fail('Should not have received Error: ' + JSON.stringify(error));\r\n         }\r\n      )\r\n      .then(done);\r\n   });\r\n});\r\n```\r\n\r\nOr, if you find the syntax too verbose and you feel confident, you can always use the condensed version:\r\n```javascript\r\ndescribe('Google Analytics \"click\" tracking', function () {\r\n   it('should fire an Event when clicking on the Jumbotron CTA', function (done) {\r\n      // Click on the \"Jumbotron\" CTA:\r\n      element( by.css('#jumbotronCTA') ).click();\r\n\r\n      // Get the \"gaLastEventData\" object back from the browser and validate its data:\r\n      browser.driver.executeScript(function () { return window.gaLastEventData; })\r\n      .then(function (gaLastEventData) {\r\n         expect(gaLastEventData).toEqual(['send', 'event', 'Button', 'Click', 'Jumbotron CTA']);\r\n         done();\r\n      });\r\n   });\r\n});\r\n```\r\n\r\n### Getting the Google Analytics Event data\r\n\r\n#### Base mechanics\r\n\r\nHow do you know which Event structure to expect in order to write your tests?\r\n\r\nLet's say your standard `ga()` call looks like this when clicking on the _Jumbotron CTA_ of the demo application (will be the same if Event Tracking is set through GTM*):\r\n```javascript\r\nga('send', 'event', 'Button', 'Click', 'Jumbotron CTA');\r\n    │       │        │         │        └──> 5. Event Label\r\n    │       │        │         └───────────> 4. Event Action\r\n    │       │        └─────────────────────> 3. Event Category\r\n    │       └──────────────────────────────> 2. (Standard Google Analytics parameter)\r\n    └──────────────────────────────────────> 1. (Standard Google Analytics parameter)\r\n```\r\nThen, after the `ga()` is executed, the value of `window.gaLastEventData` will be:\r\n```javascript\r\n  ['send', 'event', 'Button', 'Click', 'Jumbotron CTA']\r\n    │       │        │         │        └──> 5. Event Label\r\n    │       │        │         └───────────> 4. Event Action\r\n    │       │        └─────────────────────> 3. Event Category\r\n    │       └──────────────────────────────> 2. (Standard Google Analytics parameter)\r\n    └──────────────────────────────────────> 1. (Standard Google Analytics parameter)\r\n```\r\nYou then just need to use the Jasmine-provided matchers to make sure that the actual value of `window.gaLastEventData` is the same as the expected one.\r\n\r\n*: _If using Event tracking through Google Tag Manager (GTM), then the Container will generate some JavaScript exactly matching the pattern of the `ga()` call above. Just add the `send` and `event` values to the Array._\r\n\r\n#### Data Structure for Pageviews, Metrics / Dimensions, Enhanced E-Commerce, etc.\r\n\r\nJust follow the same pattern as above for [Pageviews](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#customs \"Pageviews\"), [Custom Metrics & Dimensions](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#customs \"Custom Metrics / Dimensions\"), [Enhanced E-Commerce](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#enhanced-ecomm \"Enhanced E-Commerce\"), [Social Interactions](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#social \"Social Interactions\"), [Timings](https://developers.google.com/analytics/devguides/collection/analyticsjs/field-reference#timing \"Timings\") or any other `ga()` call:\r\n\r\n##### Pageviews:\r\n```javascript\r\n  ['send', 'pageview']\r\n    │       └──────────────────────────────> 2. (Standard Google Analytics parameter)\r\n    └──────────────────────────────────────> 1. (Standard Google Analytics parameter)\r\n```\r\n\r\n##### Custom Metrics / Dimensions:\r\n```javascript\r\n  ['set', 'metric1', '123']\r\n    │      │          └────────────────────> 3. Metric Value\r\n    │      └───────────────────────────────> 2. Metric Index\r\n    └──────────────────────────────────────> 1. (Standard Google Analytics parameter)\r\n  \r\n  ['set', 'dimension1', 'Visitor']\r\n    │      │             └─────────────────> 3. Dimension Value\r\n    │      └───────────────────────────────> 2. Dimension Index\r\n    └──────────────────────────────────────> 1. (Standard Google Analytics parameter)\r\n```\r\n\r\n##### Enhanced E-Commerce:\r\n```javascript\r\n  ['ec:addProduct', { ─────────────────────> 1. (Standard Google Analytics parameters)\r\n     'id': 'P12345', ──────────────────────> 2. Product ID\r\n     'name': 'Android Warhol T-Shirt', ────> 3. Product Name\r\n     'category': 'Apparel', ───────────────> 4. Product Category\r\n     'brand': 'Google', ───────────────────> 5. Product Brand\r\n     'variant': 'black', ──────────────────> 6. Product Variant\r\n     'price': '29.20', ────────────────────> 7. Product Price\r\n     'quantity': 1   ──────────────────────> 8. Product quantity\r\n  }]\r\n  \r\n  ['ec:setAction', 'checkout', { ──────────> 1&2. (Standard Google Analytics parameters)\r\n     'step': 1, ───────────────────────────> 3. Checkout Step\r\n     'option': 'MasterCard' ───────────────> 4. Checkout Option\r\n  }]\r\n```\r\n\r\n##### Social Interactions:\r\n```javascript\r\n  ['send', 'social', { ────────────────────> 1&2. (Standard Google Analytics parameters)\r\n     'socialNetwork': 'Facebook', ─────────> 3. Social Interaction Network\r\n     'socialAction': 'Like', ──────────────> 4. Social Interaction Action\r\n     'socialTarget': 'http://test.com' ────> 5. Social Interaction Target (URL)\r\n  }]\r\n```\r\n\r\n##### Timings:\r\n```javascript\r\n  ['send', 'timing', { ────────────────────> 1&2. (Standard Google Analytics parameters)\r\n     'timingCategory': 'External Libs', ───> 3. Timing Category\r\n     'timingVar': 'Load Time', ────────────> 4. Timing Variable\r\n     'timingValue': 123, ──────────────────> 5. Timing Value (in ms)\r\n     'timingLabel': 'jQuery' ──────────────> 6. Timing Label\r\n  }]\r\n```\r\n\r\n## Installing the Library\r\n\r\nTo get started, simply clone this repository and install the dependencies:\r\n\r\n```\r\ngit clone https://github.com/philsawicki/GoogleAnalytics-WebTester.git\r\nnpm install\r\n```\r\n\r\n## Running the Demo Application\r\n\r\nThe project comes preconfigured with a simple web server. If you want, you can check the demo by opening up a browser and heading over to `http://localhost:8000/app/index.html#/`.\r\n\r\n```\r\nnpm start\r\nnpm run protractor\r\n```\r\n\r\nThe tests should now run, and the calls to Google Analytics' `ga()` method should be intercepted and logged to the console.\r\n\r\n## Contact\r\n\r\nFor more information, please check out [http://philippesawicki.com](http://philippesawicki.com \"Philippe Sawicki - Fullstack Developer and Digital Analyst\")\r\n","google":"UA-60737019-3","note":"Don't delete this file! It's used internally to help with page regeneration."}